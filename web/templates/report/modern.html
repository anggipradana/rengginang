<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <title>Report</title>
        <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500&display=swap"
              rel="stylesheet" />
        <style>
      @page {
          size: A4;
          margin: 25mm 15mm;

          @bottom-left {
            {% if show_footer %}
            content: "{{footer_text}}";
            {% else %}
            content: '';
            {% endif %}
            width: 100%;
            border-top: 1px dashed #696969;
            position: absolute;
            bottom: 5mm;
            left: 0;
        }

          @bottom-right {
            content: counter(page);
            font-family: 'Inter', sans-serif;
            font-size: 10pt;
            padding-right: 10mm;
        }

          @page :first {
            padding: 0;
            margin: 0;
        }

        @page end-of-report {
            padding: 0;
            margin: 0;
        }

      }

       html {
          color: #696969;
          font-family: 'Inter';
          font-weight: 300;
          font-size: 11pt;
          line-height: 1.5;
      }

      body {
          margin: 0;
          padding: 0;
          font-family: 'Inter', sans-serif;
      }

      * {
          font-family: inherit;
      }

      #cover {
          position: relative;
          overflow: hidden;
          background-color: {{secondary_color}};
          width: 210mm;
          height: 297mm;
      }

      @page :first {
        margin: 0 !important;
      }

      /* Cover: classification label */
      .cover-classification {
          position: absolute;
          top: 12mm;
          left: 15mm;
          right: 15mm;
          text-align: center;
          font-size: 9pt;
          font-weight: 500;
          letter-spacing: 4px;
          text-transform: uppercase;
          color: {{primary_color}};
          border-top: 2px solid {{primary_color}};
          border-bottom: 2px solid {{primary_color}};
          padding: 2mm 0;
      }

      /* Cover: company logo */
      .cover-logo {
          position: absolute;
          top: 30mm;
          left: 18mm;
      }
      .cover-logo img {
          max-width: 50mm;
          max-height: 20mm;
          object-fit: contain;
      }

      /* Cover: main content */
      .cover-content {
          position: absolute;
          top: 65mm;
          left: 18mm;
          right: 18mm;
      }

      .cover-company-name {
          font-size: 11pt;
          font-weight: 400;
          color: rgba(255, 255, 255, 0.6);
          letter-spacing: 2px;
          text-transform: uppercase;
          margin-bottom: 5mm;
      }

      .cover-accent-line {
          width: 20mm;
          height: 1.5px;
          background-color: {{primary_color}};
          margin-bottom: 8mm;
      }

      .cover-title {
          font-size: 32pt;
          font-weight: 200;
          color: {{primary_color}};
          text-transform: uppercase;
          letter-spacing: 2px;
          line-height: 1.2;
          margin: 0 0 8mm 0;
      }

      .cover-gradient-divider {
          width: 90%;
          height: 1.5px;
          background: linear-gradient(to right, {{primary_color}}, transparent);
          margin-bottom: 10mm;
      }

      /* Cover: meta info */
      .cover-meta {
          position: absolute;
          top: 180mm;
          left: 18mm;
          right: 18mm;
      }

      .cover-meta-row {
          display: flex;
          margin-bottom: 3mm;
      }

      .cover-meta-label {
          font-size: 8pt;
          font-weight: 500;
          color: rgba(255, 255, 255, 0.4);
          text-transform: uppercase;
          letter-spacing: 1px;
          width: 35mm;
      }

      .cover-meta-value {
          font-size: 10pt;
          font-weight: 300;
          color: rgba(255, 255, 255, 0.85);
      }

      /* Cover: footer */
      .cover-footer {
          position: absolute;
          bottom: 0;
          left: 0;
          right: 0;
          background-color: {{primary_color}};
          color: {{secondary_color}};
          padding: 8mm 15mm;
          font-size: 9pt;
          text-align: center;
      }

      .rengginang-banner {
          margin-top: 3mm;
          font-size: 7pt;
          opacity: 0.8;
      }

      h1 {
          font-weight: 200;
          font-size: 38pt;
          color: {{primary_color}};
          margin: 0 0 10mm 0;
          text-transform: uppercase;
          letter-spacing: 2px;
          font-family: 'Inter';
          position: relative;
          display: block;
      }

      h2,
      h3,
      h4 {
          font-family: 'Inter';
          font-weight: 200;
          color: black;
          font-weight: 400;
          line-height: normal;
          position: relative;
          display: block;
          color: #696969;
      }

      h1::after, h2::after {
          content: '';
          display: block;
          height: 1.2px;
          width: 100%;
          position: absolute;
          bottom: -2mm;
          left: 0;
          background: linear-gradient(to right, {{primary_color}}, rgba(255, 255, 255, 0));
      }

      .no-fade-line::after {
          content: none;
      }

      {% comment %} table of content page {% endcomment %}
      .toc-modern {
          background-color: white;
          font-family: 'Inter', sans-serif;
          page-break-before: always;
      }

      .toc-title {
          font-size: 24pt;
          font-weight: 400;
          text-transform: uppercase;
          letter-spacing: 2px;
          color: {{primary_color}};
      }

      .toc-list {
          display: flex;
          flex-direction: column;
          gap: 10mm;
      }

      .toc-item {
          display: flex;
          align-items: center;
          padding: 5mm 0;
          border-bottom: 1px solid rgba(0, 0, 0, 0.1);
      }

      .toc-number {
          font-size: 14pt;
          font-weight: 700;
          color: {{primary_color}};
          margin-left: auto;
          float: none;
      }

      .toc-number::after {
          content: target-counter(attr(data-href), page);
          margin-left: 5mm;
      }

      .toc-link {
          color: #696969;
          text-decoration: none;
          font-size: 14pt;
          font-weight: 400;
      }

      #executive-summary-page {
          justify-content: space-between;
          background-color: white;
          font-family: 'Inter', sans-serif;
          page-break-before: always;
      }

      #quick-summary-page {
          justify-content: space-between;
          background-color: white;
          font-family: 'Inter', sans-serif;
          page-break-before: always;
      }

      #summary-of-finding-page {
          justify-content: space-between;
          background-color: white;
          font-family: 'Inter', sans-serif;
          page-break-before: always;
      }

      #vulnerability-breakdown-chart-page {
          justify-content: space-between;
          background-color: white;
          font-family: 'Inter', sans-serif;
          page-break-before: always;
      }

      .page-title {
          font-size: 24pt;
          color: {{primary_color}};
      }

      @page end-of-report {
          background: {{primary_color}};
          margin: 0;

          @top-left {
          content: none
          }

          @top-center {
          content: none
          }

          @top-right {
          content: none
          }
      }

      .content-wrapper {
          text-align: center;
          width: 100%;
      }

      #end-of-report {
          align-items: center;
          display: flex;
          height: 297mm;
          justify-content: center;
          page: end-of-report;
          background-color: {{secondary_color}};
      }

      #end-of-report h1 {
          color: {{primary_color}};
          font-size: 48pt;
          font-weight: 200;
          margin: 0 0 20mm 0;
      }


      {% comment %} this line fades from both sides {% endcomment %}
      .fading-line-both {
          width: 180mm;
          height: 1px;
          margin: 0 auto;
          background: linear-gradient(to right,
              transparent,
              {{primary_color}} 20%,
              {{primary_color}} 80%,
              transparent
          );
      }

      {% comment %} for the quick summary boxes {% endcomment %}
      .grid {
          display: flex;
          justify-content: space-between;
          width: 170mm;
          margin-bottom: 8mm;
      }
      .box {
          width: 50mm;
          height: 20mm;
          background-color: #f8f9fa;
          border-radius: 2mm;
          padding: 2mm;
          position: relative;
          overflow: hidden;
          box-shadow: 0 1mm 2mm rgba(0,0,0,0.1);
      }
      .box::before {
          content: '';
          position: absolute;
          top: 0;
          right: 0;
          border-style: solid;
          border-width: 0 6mm 6mm 0;
          border-color: transparent #3498db transparent transparent;
      }
      .box h4 {
          font-size: 9pt;
          margin: 0 0 1mm 0;
          display: flex;
          align-items: center;
      }
      .box .number {
          font-size: 25pt;
          font-weight: 200;
          position: absolute;
          bottom: 2mm;
          right: 2mm;
      }
      .icon {
          width: 3mm;
          height: 3mm;
          margin-right: 1mm;
          display: inline-block;
          vertical-align: middle;
      }
      .critical { border-left: 1mm solid #e74c3c; }
      .high { border-left: 1mm solid #e67e22; }
      .medium { border-left: 1mm solid #f39c12; }
      .low { border-left: 1mm solid #27ae60; }
      .info { border-left: 1mm solid #3498db; }
      .unknown { border-left: 1mm solid #95a5a6; }
      .critical .number, .critical::before { color: #e74c3c; border-right-color: #e74c3c; }
      .high .number, .high::before { color: #e67e22; border-right-color: #e67e22; }
      .medium .number, .medium::before { color: #f39c12; border-right-color: #f39c12; }
      .low .number, .low::before { color: #27ae60; border-right-color: #27ae60; }
      .info .number, .info::before { color: #3498db; border-right-color: #3498db; }
      .unknown .number, .unknown::before { color: #95a5a6; border-right-color: #95a5a6; }
      .primary { color: {{primary_color}}; }

      {% comment %} table related {% endcomment %}
      .vuln-summary-table-container {
        width: 100%;
        margin: auto auto;
        background-color: #ffffff;
        border-radius: 4mm;
        overflow: hidden;
      }
      .vuln-summary-table {
        width: 100%;
        border-collapse: separate;
        border-spacing: 0.5mm;
        background-color: #ffffff;
      }
      .vuln-summary-table th, .vuln-summary-table td {
        padding: 2.5mm 3mm;
        text-align: center;
        vertical-align: middle;
      }
      .vuln-summary-table th {
        background-color: #4a5568;
        color: white;
        font-weight: bold;
      }
      .vuln-summary-table .vulnerability-td {
        text-align: left !important;
      }
      .vulnerability-td a {
        color: inherit;
        text-decoration: none;
        font-weight: inherit;
      }
      .number-td {
        width: 5mm;
        text-align: center;
        color: rgba(0, 0, 0, 0.5);
        font-weight: normal;
      }
      .vulnerability-td {
        width: 100mm;
        text-align: left;
      }
      .instances-td {
        width: 10mm;
        text-align: center;
      }
      .severity-td {
        width: 10mm;
        text-align: center;
        font-weight: bold;
      }
      .unknown-td { background-color: #f7f7f7; color: #777777; }
      .info-td { background-color: #e3f2fd; color: #1565c0; }
      .low-td { background-color: #e8f5e9; color: #2e7d32; }
      .medium-td { background-color: #fff3e0; color: #ef6c00; }
      .high-td { background-color: #fbe9e7; color: #d84315; }
      .critical-td { background-color: #ffebee; color: #c62828; }

      .unknown-severity-badge { background-color: rgba(200, 200, 200, 0.2); }
      .info-severity-badge { background-color: rgba(144, 202, 249, 0.2); }
      .low-severity-badge { background-color: rgba(165, 214, 167, 0.2); }
      .medium-severity-badge { background-color: rgba(255, 204, 128, 0.2); }
      .high-severity-badge { background-color: rgba(239, 154, 154, 0.2); }
      .critical-severity-badge { background-color: rgba(239, 154, 154, 0.2); }



      .center-img {
        display: block;
        margin-left: auto;
        margin-right: auto;
        width: 50%;
      }
      {% comment %} stripped table {% endcomment %}
        .table-stripped tr:nth-child(odd) {
            background-color: #f9f9f9;
        }
        .table-stripped tr:nth-child(even) {
           background-color: #f2f2f2;
        }

      {% comment %} interesting-subdomain-table {% endcomment %}
      .interesting-subdomain-table-container {
        width: 100%;
        margin: auto auto;
        background-color: #ffffff;
        border-radius: 4mm;
        overflow: hidden;
      }
      .interesting-subdomain-table {
        width: 100%;
        border-collapse: separate;
        border-spacing: 0.5mm;
        background-color: #ffffff;
      }
      .interesting-subdomain-table th, .interesting-subdomain-table td {
        padding: 2.5mm 3mm;
        text-align: center;
        vertical-align: middle;
      }
      .interesting-subdomain-table th {
        background-color: #696969;
        color: white;
        font-weight: bold;
      }
      .interesting-subdomain-table .page-title-td {
        text-align: left !important;
      }
      .interesting-subdomain-table .subdomain-name-td {
        text-align: left !important;
      }
      .status-td {
        width: 10mm;
        text-align: center;
        font-weight: bold;
      }
      .normal-td {
        width: 10mm;
        text-align: center;
      }
        /* recon finding card table */
        .subdomain-card {
            width: 100%;
            margin-bottom: 3mm;
            border: 1px solid #ddd;
            border-radius: 4mm;
            overflow: hidden;
            box-shadow: 0 1mm 2mm rgba(0, 0, 0, 0.1);
        }
        .subdomain-card-header {
            background-color: #f0f0f0;
            padding: 2mm;
            border-bottom: 1px solid #ddd;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .subdomain-card-name {
            font-weight: bold;
            color: #2c3e50;
            font-size: 11pt;
        }
        .subdomain-card-http-status {
            padding: 1mm 2mm;
            border-radius: 1mm;
            font-size: 13pt;
        }
        .subdomain-card-content {
            padding: 3mm;
        }
        .subdomain-card-page-title {
            font-style: italic !important;
            color: #7f8c8d;
            margin-bottom: 1mm;
            font-size: 10pt;
        }
        {% comment %} vuln finding related css {% endcomment %}
        .vuln-card {
            background-color: #ffffff;
            margin-bottom: 7mm;
            border-radius: 4mm;
            box-shadow: 0 2mm 4mm rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .vuln-card-header {
            padding: 1mm 4mm;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        .card-header h4 {
            font-size: 14pt;
            margin: 0;
            font-weight: 500;
        }
        .vuln-severity {
            font-size: 11pt;
            font-weight: bold;
            padding: 1mm 3mm;
            border-radius: 2mm;
        }
        .vuln-badge {
            display: inline-block;
            padding: 1mm 3mm;
            border-radius: 2mm;
            font-size: 9pt;
            font-weight: bold;
            text-transform: uppercase;
            margin-right: 3mm;
            margin-bottom: 2mm;
        }
        .badge-source {
            background-color: #2ecc71;
            color: white;
        }
        .badge-cvss {
            background-color: #e74c3c;
            color: white;
        }
        .badge-cve {
            background-color: #3498db;
            color: white;
        }

        .badge-cwe {
            background-color: #9b59b6;
            color: white;
        }
        .vuln-card-body {
            padding: 5mm 2mm;
        }
        .vuln-section {
            margin-bottom: 4mm;
            padding-bottom: 4mm;
            border-bottom: 1pt solid #e0e0e0;
        }
        .vuln-section:last-child {
            border-bottom: none;
        }
        .section-title {
            font-weight: bold;
            color: #2c3e50;
            font-size: 11pt;
            margin-bottom: 2mm;
            text-transform: uppercase;
        }
        .vuln-cvss-details {
            background-color: #f8f9fa;
            padding: 4mm;
            border-radius: 2mm;
            font-family: monospace;
            font-size: 9pt;
        }
        .vulnerable-url-li {
            background-color: #fff3cd;
            padding: 2mm 4mm;
            margin-bottom: 2mm;
            border-radius: 2mm;
            font-family: monospace;
            font-size: 9pt;
        }
        .references-li a {
            color: #3498db;
            text-decoration: none;
        }
        .no-style-a{
            color: #3498db;
            text-decoration: none;
        }
        </style>
    </head>
    <body>
        {% comment %} cover page {% endcomment %}
        <article id="cover">
            <div class="cover-classification">{{ labels.confidential }}</div>

            {% if company_logo_path %}
            <div class="cover-logo">
                <img src="file://{{ company_logo_path }}" alt="Company Logo" />
            </div>
            {% endif %}

            <div class="cover-content">
                <div class="cover-company-name">{{ company_name }}</div>
                <div class="cover-accent-line"></div>
                <div class="cover-title">{{ report_name }}</div>
                <div class="cover-gradient-divider"></div>
            </div>

            <div class="cover-meta">
                {% if document_number %}
                <div class="cover-meta-row">
                    <div class="cover-meta-label">{{ labels.document_number }}</div>
                    <div class="cover-meta-value">{{ document_number }}</div>
                </div>
                {% endif %}
                <div class="cover-meta-row">
                    <div class="cover-meta-label">{{ labels.target }}</div>
                    <div class="cover-meta-value">{{ scan_object.domain.name }}</div>
                </div>
                <div class="cover-meta-row">
                    <div class="cover-meta-label">{{ labels.date }}</div>
                    <div class="cover-meta-value">{% now "F j, Y" %}</div>
                </div>
                <div class="cover-meta-row">
                    <div class="cover-meta-label">{{ labels.version }}</div>
                    <div class="cover-meta-value">1.0</div>
                </div>
            </div>

            <div class="cover-footer">
                {{ company_name }} | {{ company_address }} | {{ company_email }} |
                {{ company_website }}
                {% if show_rengginang_banner %}
                    <div class="rengginang-banner">
                        Generated by ReNgGinaNg
                    </div>
                {% endif %}
            </div>
        </article>
        {% comment %} table of contents {% endcomment %}
        <article class="toc-modern">
            <div class="page-content-wrapper">
                <h1 class="toc-title page-title">{{ labels.table_of_contents }}</h1>
                <div class="toc-list">
                    {% if show_executive_summary %}
                        <div class="toc-item">
                            <a href="#executive-summary" class="toc-link">{{ labels.executive_summary }}</a>
                            <span class="toc-number" data-href="#executive-summary"></span>
                        </div>
                    {% endif %}
                    <div class="toc-item">
                        <a href="#quick-summary" class="toc-link">{{ labels.quick_summary }}</a>
                        <span class="toc-number" data-href="#quick-summary"></span>
                    </div>
                    <div class="toc-item">
                        <a href="#assessment-timeline" class="toc-link">{{ labels.assessment_timeline }}</a>
                        <span class="toc-number" data-href="#assessment-timeline"></span>
                    </div>
                    <div class="toc-item">
                        <a href="#summary-of-finding-page" class="toc-link">{{ labels.summary_of_findings }}</a>
                        <span class="toc-number" data-href="#summary-of-finding-page"></span>
                    </div>
                    {% if show_recon %}
                        <div class="toc-item">
                            <a href="#discovered-assets" class="toc-link">{{ labels.discovered_assets }}</a>
                            <span class="toc-number" data-href="#discovered-assets"></span>
                        </div>
                        <div class="toc-item">
                            <a href="#reconnaissance-findings" class="toc-link">{{ labels.reconnaissance_findings }}</a>
                            <span class="toc-number" data-href="#reconnaissance-findings"></span>
                        </div>
                    {% endif %}
                    {% if show_vuln %}
                        <div class="toc-item">
                            <a href="#vulnerabilities-discovered" class="toc-link">{{ labels.vulnerabilities_discovered }}</a>
                            <span class="toc-number" data-href="#vulnerabilities-discovered"></span>
                        </div>
                    {% endif %}
                </div>
            </div>
        </article>
        {% if show_executive_summary %}
            <article id="executive-summary-page">
                <h2 id="executive-summary" class="page-title">{{ labels.executive_summary }}</h2>
                <br />
                {{ executive_summary_description | safe }}
                {% if ai_remediation_summary %}
                <div style="margin-top: 8mm; padding-top: 4mm; border-top: 1px solid #e0e0e0;">
                    {{ ai_remediation_summary | safe }}
                </div>
                {% endif %}
            </article>
        {% endif %}
        <article id="quick-summary-page">
            <h2 id="quick-summary" class="page-title">{{ labels.quick_summary }}</h2>
            <p>
                {{ labels.quick_summary_desc }}
                <span class="primary-color">{{ scan_object.domain.name }}</span>
            </p>
            <br />
            {% if show_recon %}
                <div class="section">
                    <h3 class="primary">{{ labels.reconnaissance }}</h3>
                    <div class="grid">
                        <div class="box info">
                            <h4>{{ labels.subdomains }}</h4>
                            <div class="number">{{ scan_object.get_subdomain_count }}</div>
                        </div>
                        <div class="box info">
                            <h4>{{ labels.endpoints }}</h4>
                            <div class="number">{{ scan_object.get_endpoint_count }}</div>
                        </div>
                        <div class="box critical">
                            <h4>{{ labels.vulnerabilities }}</h4>
                            <div class="number">{{ all_vulnerabilities_count }}</div>
                        </div>
                    </div>
                </div>
            {% endif %}
            {% if show_vuln %}
                <div class="section">
                    <h3 class="primary">{{ labels.vulnerability_summary }}</h3>
                    <div class="grid">
                        <div class="box critical">
                            <h4>{{ labels.critical }}</h4>
                            <div class="number">{{ scan_object.get_critical_vulnerability_count }}</div>
                        </div>
                        <div class="box high">
                            <h4>{{ labels.high }}</h4>
                            <div class="number">{{ scan_object.get_high_vulnerability_count }}</div>
                        </div>
                        <div class="box medium">
                            <h4>{{ labels.medium }}</h4>
                            <div class="number">{{ scan_object.get_medium_vulnerability_count }}</div>
                        </div>
                    </div>
                    <div class="grid">
                        <div class="box low">
                            <h4>{{ labels.low }}</h4>
                            <div class="number">{{ scan_object.get_low_vulnerability_count }}</div>
                        </div>
                        <div class="box info">
                            <h4>{{ labels.info }}</h4>
                            <div class="number">
                                {% if is_ignore_info_vuln %}
                                    0
                                {% else %}
                                    {{ scan_object.get_info_vulnerability_count }}
                                {% endif %}
                            </div>
                        </div>
                        <div class="box unknown">
                            <h4>{{ labels.unknown }}</h4>
                            <div class="number">{{ scan_object.get_unknown_vulnerability_count }}</div>
                        </div>
                    </div>
                </div>
            {% endif %}
        </article>
        <article style="page-break-before: always;">
            <h2 id="assessment-timeline" class="page-title">{{ labels.assessment_timeline }}</h2>
            <p>
                {{ labels.scan_started_on }}: {{ scan_object.start_scan_date|date:"F j, Y h:i" }}
                <br>
                {{ labels.total_time_taken }}:
                {% if scan_object.scan_status == 0 %}
                    {{ scan_object.start_scan_date|timesince:scan_object.stop_scan_date }}
                {% elif scan_object.scan_status == 1 %}
                    {{ scan_object.get_elapsed_time }}
                {% elif scan_object.scan_status == 2 %}
                    {% if scan_object.get_completed_time_in_sec < 60 %}
                        {{ labels.completed_less_1_min }}
                    {% else %}
                        {{ labels.completed_in }} {{ scan_object.start_scan_date|timesince:scan_object.stop_scan_date }}
                    {% endif %}
                {% elif scan_object.scan_status == 3 %}
                    {{ labels.aborted_in }}
                    {{ scan_object.start_scan_date|timesince:scan_object.stop_scan_date }}
                {% endif %}
                <br>
                {{ labels.report_generated_on }}: {% now "F j, Y" %}
            </p>
        </article>
        <article id="summary-of-finding-page">
            <h2 class="page-title">{{ labels.summary_of_findings }}</h2>
            <div class="">
                <p>{{ labels.summary_of_findings_desc }}</p>
            </div>
            <h3 class="primary">{{ labels.subdomains_by_http_status }}</h3>
            <img class="center-img"
                 src="data:image/png;base64,{{ subdomain_http_status_chart }}" />
            {% if show_vuln and unique_vulnerabilities %}
                <h3 class="primary">{{ labels.vulns_by_severity }}</h3>
                <img class="center-img"
                     src="data:image/png;base64,{{ vulns_severity_chart }}" />
            {% endif %}
        </article>
        {% if show_vuln %}
            <article style="page-break-before: always;">
                <h3 class="primary">{{ labels.summary_of_vulns }}</h3>
                {% if all_vulnerabilities.count == 0 %}
                    <p>
                        {{ labels.no_vulns_identified }} <span class="primary">{{ scan_object.domain.name }}</span>
                    </p>
                {% else %}
                    <p>
                        {{ labels.vulns_listed }} <span class="primary-color">{{ scan_object.domain.name }}</span>
                    </p>
                    <div class="vuln-summary-table-container">
                        <table class="vuln-summary-table">
                            <tr>
                                <th class="number-td">#</th>
                                <th class="vulnerability-td">{{ labels.vulnerability_name }}</th>
                                <th class="instances-td">{{ labels.instances }}</th>
                                <th class="severity-td">{{ labels.severity }}</th>
                            </tr>
                            {% for vulnerability in unique_vulnerabilities %}
                                <tr class="{% if vulnerability.severity == -1 %}unknown-td {% elif vulnerability.severity == 0 %}info-td {% elif vulnerability.severity == 1 %}low-td {% elif vulnerability.severity == 2 %}medium-td {% elif vulnerability.severity == 3 %}high-td {% elif vulnerability.severity == 4 %}critical-td {% else %}unknown-td{% endif %}">
                                    <td class="number-td">{{ forloop.counter }}</td>
                                    <td class="vulnerability-td">
                                        <a href="#vuln_{{ vulnerability.name.split|join:'_' }}">{{ vulnerability.name }}</a>
                                    </td>
                                    <td class="instances-td">{{ vulnerability.count }}</td>
                                    <td class="severity-td">
                                        {% if vulnerability.severity == -1 %}
                                            {{ labels.unknown }}
                                        {% elif vulnerability.severity == 0 %}
                                            {{ labels.informational }}
                                        {% elif vulnerability.severity == 1 %}
                                            {{ labels.low }}
                                        {% elif vulnerability.severity == 2 %}
                                            {{ labels.medium }}
                                        {% elif vulnerability.severity == 3 %}
                                            {{ labels.high }}
                                        {% elif vulnerability.severity == 4 %}
                                            {{ labels.critical }}
                                        {% endif %}
                                    </td>
                                </tr>
                            {% endfor %}
                        </table>
                    </div>
                {% endif %}
            </article>
        {% endif %}
        {% if show_recon %}
            <article style="page-break-before: always;">
                <h2 class="page-title" id="discovered-assets">{{ labels.discovered_assets }}</h2>
                <p>{{ labels.discovered_assets_desc }}</p>
                <h3 class="primary">{{ labels.subdomains }}</h3>
                <p>{{ labels.recon_subdomains_desc }}</p>
                <ol>
                    <li>
                        <strong>{{ labels.total_subdomains }}:</strong> {{ scan_object.get_subdomain_count }}
                        <ul>
                            <li>{{ labels.total_subdomains_desc }}</li>
                        </ul>
                    </li>
                    <li>
                        <strong>{{ labels.active_subdomains }}:</strong> {{ subdomain_alive_count }}
                        <ul>
                            <li>{{ labels.active_subdomains_desc }}</li>
                        </ul>
                    </li>
                    <li>
                        <strong>{{ labels.interesting_subdomains }}:</strong> {{ interesting_subdomains.count }}
                        <ul>
                            <li>{{ labels.interesting_subdomains_desc }}</li>
                        </ul>
                    </li>
                </ol>
                <h4>
                    {{ scan_object.get_subdomain_count }} {{ labels.subdomains_identified_on }} <span class="primary">{{ scan_object.domain.name }}</span>
                </h4>
                <div class="interesting-subdomain-table-container">
                    <table class="interesting-subdomain-table">
                        <tr>
                            <th class="number-td">#</th>
                            <th class="interesting-subdomain-td">{{ labels.subdomain }}</th>
                            <th class="page-title-td">{{ labels.page_title }}</th>
                            <th class="status-td">{{ labels.http_status }}</th>
                            {% if show_vuln %}<th class="status-td">{{ labels.vulnerabilities_count }}</th>{% endif %}
                        </tr>
                        {% for subdomain in subdomains %}
                            <tr class=" {% if subdomain.http_status >= 200 and subdomain.http_status < 300 %} low-td {% elif subdomain.http_status >= 300 and subdomain.http_status < 400 %} medium-td {% elif subdomain.http_status >= 400 and subdomain.http_status < 500 %} high-td {% else %} unknown-td {% endif %} ">
                                <td class="number-td">{{ forloop.counter }}</td>
                                <td class="subdomain-name-td"><a href="#subdomain_{{subdomain.name}}" class="no-style-a">{{ subdomain.name }}</a></td>
                                <td class="page-title-td">
                                    {% if subdomain.page_title %}{{ subdomain.page_title }}{% endif %}
                                </td>
                                <td class="status-td">
                                    {% if subdomain.http_status %}{{ subdomain.http_status }}{% endif %}
                                </td>
                                {% if show_vuln %}
                                    <td class="status-td">
                                        {% if subdomain.get_total_vulnerability_count %}
                                            {{ subdomain.get_total_vulnerability_count }}
                                        {% else %}
                                            0
                                        {% endif %}
                                    </td>
                                {% endif %}
                            </tr>
                        {% endfor %}
                    </table>
                </div>
                {% if ip_addresses.count > 0 %}
                    <h3 class="primary">{{ labels.ip_assets }}</h3>
                    <p>{{ labels.ip_assets_desc }}</p>
                    <ol>
                        <li>
                            <strong>{{ labels.total_ip_addresses }}:</strong> {{ ip_addresses.count }}
                            <ul>
                                <li>{{ labels.total_ip_desc }}</li>
                            </ul>
                        </li>
                    </ol>
                    <div class="interesting-subdomain-table-container">
                        <table class="interesting-subdomain-table table-stripped">
                            <tr>
                                <th class="number-td">#</th>
                                <th class="interesting-subdomain-td">IP</th>
                                <th class="page-title-td">{{ labels.open_ports }}</th>
                                <th class="normal-td">{{ labels.geo_location }}</th>
                                <th class="normal-td">{{ labels.remarks }}</th>
                            </tr>
                            {% for ip in ip_addresses %}
                                <tr>
                                    <td class="number-td">{{ forloop.counter }}</td>
                                    <td class="subdomain-name-td">{{ ip.address }}</td>
                                    <td class="page-title-td">
                                        {% for port in ip.ports.all %}
                                            {{ port.number }}/{{ port.service_name }}
                                            {% if not forloop.last %},{% endif %}
                                        {% endfor %}
                                    </td>
                                    <td class="normal-td">
                                        {% if ip.geo_iso %}{{ ip.geo_iso }}{% endif %}
                                    </td>
                                    <td class="normal-td">
                                        {% if ip.is_cdn %}CDN{% endif %}
                                    </td>
                                </tr>
                            {% endfor %}
                        </table>
                    </div>
                {% endif %}
            </article>
        {% endif %}
        {% if show_recon %}
            <article style="page-break-before: always;">
                <h2 class="page-title" id="reconnaissance-findings">{{ labels.reconnaissance_findings }}</h2>
                <p>{{ labels.recon_findings_desc }}</p>
                {% for subdomain in subdomains %}
                    <div class="subdomain-card" id="subdomain_{{subdomain.name}}">
                        <div class="subdomain-card-header">
                            <span class="subdomain-card-name">{{ subdomain.name }}</span>
                            {% if subdomain.http_status %}
                                <span class="subdomain-card-http-status {% if subdomain.http_status >= 200 and subdomain.http_status < 300 %} low-td {% elif subdomain.http_status >= 300 and subdomain.http_status < 400 %} medium-td {% elif subdomain.http_status >= 400 and subdomain.http_status < 500 %} high-td {% else %} unknown-td {% endif %}">{{ subdomain.http_status }}</span>
                            {% endif %}
                        </div>
                        <div class="subdomain-card-content">
                            {% if subdomain.page_title %}<div class="subdomain-card-page-title">{{ subdomain.page_title }}</div>{% endif %}
                            {% if subdomain.ip_addresses.all %}
                                <div>
                                    <h4>{{ labels.ip_addresses_label }}:</h4>
                                    <ul>
                                        {% for ip in subdomain.ip_addresses.all %}
                                            <li>
                                                {{ ip.address }}
                                                {% if ip.ports.all %}
                                                    <ul>
                                                        {% for port in ip.ports.all %}<li>{{ port.number }}/{{ port.service_name }}</li>{% endfor %}
                                                    </ul>
                                                {% endif %}
                                            </li>
                                        {% endfor %}
                                    </ul>
                                </div>
                            {% endif %}
                            {% if show_vuln %}
                                {% if subdomain.get_vulnerabilities_without_info %}
                                    <div>
                                        <h4>{{ labels.vulnerabilities }}:</h4>
                                        {% regroup subdomain.get_vulnerabilities_without_info by name as vuln_list %}
                                        <ul>
                                            {% for vulnerability in vuln_list %}
                                                <li>
                                                    <a href="#vuln_{{ vulnerability.list.0.name.split|join:'_' }}"
                                                       class="primary">{{ vulnerability.grouper }}</a>
                                                </li>
                                            {% endfor %}
                                        </ul>
                                    </div>
                                {% endif %}
                            {% endif %}
                        </div>
                    </div>
                {% endfor %}
            </article>
        {% endif %}
        {% if show_vuln %}
            <article id="vulnerabilities-discovered" style="page-break-before: always;">
                <h2 class="page-title primary">{{ labels.vulnerabilities_discovered }}</h2>
                <p>
                {{ labels.vuln_section_desc }}
                <br>
                {{ labels.vuln_section_desc2 }}
                <br>
                {{ labels.vuln_section_desc3 }}</p>
                <br>
                {% regroup all_vulnerabilities by get_path as grouped_vulnerabilities %}
                {% for vulnerabilities in grouped_vulnerabilities %}
                    {% for vulnerability in vulnerabilities.list %}
                        <div class="vuln-card" id="vuln_{{ vulnerability.name.split|join:'_' }}">
                            <div class="vuln-card-header {% if vulnerability.severity == 0 %}info-td{% elif vulnerability.severity == 1 %}low-td{% elif vulnerability.severity == 2 %}medium-td{% elif vulnerability.severity == 3 %}high-td{% elif vulnerability.severity == 4 %}critical-td{% endif %}">
                                <h4>
                                    {{ vulnerability.name }}
                                    {% if vulnerabilities.grouper %}
                                        <br>
                                        {{ labels.in_target }} {{ vulnerabilities.grouper }}
                                    {% endif %}
                                </h4>
                                <div class="vuln-severity {% if vulnerability.severity == -1 %}unknown-severity-badge{% elif vulnerability.severity == 0 %}info-severity-badge{% elif vulnerability.severity == 1 %}low-severity-badge{% elif vulnerability.severity == 2 %}medium-severity-badge{% elif vulnerability.severity == 3 %}high-severity-badge{% elif vulnerability.severity == 4 %}critical-severity-badge{% endif %}">
                                    {% if vulnerability.severity == -1 %}
                                        {{ labels.unknown }}
                                    {% elif vulnerability.severity == 0 %}
                                        INFO
                                    {% elif vulnerability.severity == 1 %}
                                        LOW
                                    {% elif vulnerability.severity == 2 %}
                                        MEDIUM
                                    {% elif vulnerability.severity == 3 %}
                                        HIGH
                                    {% elif vulnerability.severity == 4 %}
                                        CRITICAL
                                    {% endif %}
                                </div>
                            </div>
                            <div class="vuln-card-body">
                                <div class="vuln-section">
                                    <span class="vuln-badge badge-source">{{vulnerability.source|upper}}</span>
                                    {% if vulnerability.cvss_score %}
                                        <span class="vuln-badge badge-cvss">CVSS: {{vulnerability.cvss_score|upper}}</span>
                                    {% endif %}
                                    {% if vulnerability.cve_ids.all %}
                                    {% for cve in vulnerability.cve_ids.all %}<span class="vuln-badge badge-cvss">{{cve|upper}}</span>{% endfor %}
                                    {% endif %}
                                    {% if vulnerability.cwe_ids.all %}
                                    {% for cwe in vulnerability.cwe_ids.all %}<span class="vuln-badge badge-cwe">{{cwe|upper}}</span>{% endfor %}
                                    {% endif %}
                                </div>
                                {% if vulnerability.cvss_metrics %}
                                <div class="vuln-section">
                                    <p class="section-title">CVSS</p>
                                    <div class="vuln-cvss-details">{{vulnerability.cvss_metrics}}</div>
                                </div>
                                {% endif %}
                                {% if vulnerability.description %}
                                <div class="vuln-section">
                                    <p class="section-title">{{ labels.description }}</p>
                                    <p>
                                        {{vulnerability.description|linebreaks}}
                                    </p>
                                </div>
                                {% endif %}
                                 {% if vulnerability.impact %}
                                    <div class="vuln-section">
                                        <p class="section-title">{{ labels.impact }}</p>
                                        <p>
                                            {{vulnerability.impact|linebreaks}}
                                        </p>
                                    </div>
                                {% endif %}
                                {% if vulnerability.remediation %}
                                <div class="vuln-section">
                                    <p class="section-title">{{ labels.remediation }}</p>
                                    <p>{{vulnerability.remediation|linebreaks}}</p>
                                </div>
                                {% endif %}
                                <div class="vuln-section">
                                    <p class="section-title">{{ labels.vulnerable_urls }}</p>
                                    <div class="vulnerable-url-li">{{vulnerability.http_url}}</div>
                                </div>
                                {% if vulnerability.references.all %}
                                <div class="vuln-section references-li">
                                    <p class="section-title">{{ labels.references }}</p>
                                    <ul>
                                        {% for ref in vulnerability.references.all %}
                                        <li>
                                            <a href="{{ref}}" target="_blank" rel="noopener noreferrer">{{ref}}</a>
                                        </li>
                                        {% endfor %}
                                    </ul>
                                </div>
                                {% endif %}
                            </div>
                        </div>
                    {% endfor %}
                {% endfor %}
            </article>
        {% endif %}
        <article id="end-of-report">
            <div class="content-wrapper">
                <h1 class="no-fade-line">{{ labels.end_of_report }}</h1>
                <div class="fading-line-both"></div>
            </div>
        </article>
    </body>
</html>
